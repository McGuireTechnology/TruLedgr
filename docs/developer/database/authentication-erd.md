# Authentication Module - Entity Relationship Diagram

## Overview

This diagram shows the database schema for the **authentication** module, including related tables from other modules that have foreign key relationships.

### Core Tables (authentication module)
- `oauth2account`
- `oauth_accounts`
- `password_reset_tokens`
- `passwordresettoken`

### Related Tables (from other modules)
- `users` (from users module)

### Total Tables in Diagram
5 tables

## Entity Relationship Diagram

```mermaid
# Authentication Module ERD\n\nerDiagram\n    USERS {\n        boolean is_deleted "Is Deleted"\n        datetime deleted_at "Deleted At"\n        datetime created_at "Created At"\n        datetime updated_at "Updated At"\n        string id PK "Id"\n        string(100) username UK "Username"\n        string(255) email UK "Email"\n        string(255) hashed_password "Hashed Password"\n        string(32) totp_secret "Totp Secret"\n        boolean totp_enabled "Totp Enabled"\n        string(1000) backup_codes "Backup Codes"\n        string(100) first_name "First Name"\n        string(100) last_name "Last Name"\n        string(500) profile_picture_url "Profile Picture Url"\n        string(1000) bio "Bio"\n        boolean is_active "Is Active"\n        boolean is_verified "Is Verified"\n        boolean email_verified "Email Verified"\n        datetime last_login "Last Login"\n        string role_id FK "Role Id"\n        boolean is_oauth_user "Is Oauth User"\n        string(50) oauth_provider "Oauth Provider"\n        string(255) oauth_provider_id "Oauth Provider Id"\n    }\n\n    OAUTH_ACCOUNTS {\n        datetime created_at "Created At"\n        datetime updated_at "Updated At"\n        string id PK "Id"\n        string user_id FK "User Id"\n        string(50) provider "Provider"\n        string(255) provider_user_id "Provider User Id"\n        string(255) provider_email "Provider Email"\n        string(255) provider_name "Provider Name"\n        string(500) provider_picture "Provider Picture"\n        string(1000) access_token "Access Token"\n        string(1000) refresh_token "Refresh Token"\n        datetime token_expires_at "Token Expires At"\n        string raw_user_data "Raw User Data"\n    }\n\n    PASSWORD_RESET_TOKENS {\n        datetime created_at "Created At"\n        datetime updated_at "Updated At"\n        string id PK "Id"\n        string(255) token_hash UK "Token Hash"\n        string user_id FK "User Id"\n        string(255) email "Email"\n        datetime expires_at "Expires At"\n        datetime used_at "Used At"\n        datetime revoked_at "Revoked At"\n        string(45) client_ip "Client Ip"\n        string(512) user_agent "User Agent"\n        string(50) previous_token_id "Previous Token Id"\n    }\n\n    PASSWORDRESETTOKEN {\n        string id PK "Id"\n        string token_hash "Token Hash"\n        string user_id FK "User Id"\n        string email "Email"\n        datetime created_at "Created At"\n        datetime expires_at "Expires At"\n        datetime used_at "Used At"\n        datetime revoked_at "Revoked At"\n        string client_ip "Client Ip"\n        string user_agent "User Agent"\n        int max_uses "Max Uses"\n        int use_count "Use Count"\n        string revocation_reason "Revocation Reason"\n    }\n\n    OAUTH2ACCOUNT {\n        int id PK "Id"\n        string user_id FK "User Id"\n        string provider "Provider"\n        string provider_user_id "Provider User Id"\n        string email "Email"\n        string first_name "First Name"\n        string last_name "Last Name"\n        string full_name "Full Name"\n        string picture_url "Picture Url"\n        boolean is_active "Is Active"\n        boolean is_email_verified "Is Email Verified"\n        datetime created_at "Created At"\n        datetime updated_at "Updated At"\n        datetime last_login_at "Last Login At"\n        string access_token "Access Token"\n        string refresh_token "Refresh Token"\n        datetime token_expires_at "Token Expires At"\n        string provider_data "Provider Data"\n    }\n\n    USERS ||--o{ PASSWORD_RESET_TOKENS : "user"\n    USERS ||--o{ OAUTH_ACCOUNTS : "user"\n    USERS ||--o{ OAUTH2ACCOUNT : "user"\n    USERS ||--o{ PASSWORDRESETTOKEN : "user"
```

## Table Descriptions

### `oauth2account`\n\n| Column | Type | Constraints | Description |\n|--------|------|-------------|-------------|\n| `id` | `INTEGER` | PK, NOT NULL | Id |\n| `user_id` | `VARCHAR` | FK → users.id, NOT NULL | User Id |\n| `provider` | `VARCHAR` | NOT NULL | Provider |\n| `provider_user_id` | `VARCHAR` | NOT NULL | Provider User Id |\n| `email` | `VARCHAR` | NOT NULL | Email |\n| `first_name` | `VARCHAR` |  | First Name |\n| `last_name` | `VARCHAR` |  | Last Name |\n| `full_name` | `VARCHAR` |  | Full Name |\n| `picture_url` | `VARCHAR` |  | Picture Url |\n| `is_active` | `BOOLEAN` | NOT NULL | Is Active |\n| `is_email_verified` | `BOOLEAN` | NOT NULL | Is Email Verified |\n| `created_at` | `DATETIME` | NOT NULL | Created At |\n| `updated_at` | `DATETIME` | NOT NULL | Updated At |\n| `last_login_at` | `DATETIME` |  | Last Login At |\n| `access_token` | `VARCHAR` |  | Access Token |\n| `refresh_token` | `VARCHAR` |  | Refresh Token |\n| `token_expires_at` | `DATETIME` |  | Token Expires At |\n| `provider_data` | `VARCHAR` |  | Provider Data |\n\n### `oauth_accounts`\n\n| Column | Type | Constraints | Description |\n|--------|------|-------------|-------------|\n| `created_at` | `DATETIME` |  | Created At |\n| `updated_at` | `DATETIME` |  | Updated At |\n| `id` | `VARCHAR` | PK, NOT NULL | Id |\n| `user_id` | `VARCHAR` | FK → users.id, NOT NULL | User Id |\n| `provider` | `VARCHAR(50)` | NOT NULL | Provider |\n| `provider_user_id` | `VARCHAR(255)` | NOT NULL | Provider User Id |\n| `provider_email` | `VARCHAR(255)` | NOT NULL | Provider Email |\n| `provider_name` | `VARCHAR(255)` |  | Provider Name |\n| `provider_picture` | `VARCHAR(500)` |  | Provider Picture |\n| `access_token` | `VARCHAR(1000)` |  | Access Token |\n| `refresh_token` | `VARCHAR(1000)` |  | Refresh Token |\n| `token_expires_at` | `DATETIME` |  | Token Expires At |\n| `raw_user_data` | `VARCHAR` |  | Raw User Data |\n\n### `password_reset_tokens`\n\n| Column | Type | Constraints | Description |\n|--------|------|-------------|-------------|\n| `created_at` | `DATETIME` |  | Created At |\n| `updated_at` | `DATETIME` |  | Updated At |\n| `id` | `VARCHAR` | PK, NOT NULL | Id |\n| `token_hash` | `VARCHAR(255)` | UNIQUE, NOT NULL | Token Hash |\n| `user_id` | `VARCHAR` | FK → users.id, NOT NULL | User Id |\n| `email` | `VARCHAR(255)` | NOT NULL | Email |\n| `expires_at` | `DATETIME` | NOT NULL | Expires At |\n| `used_at` | `DATETIME` |  | Used At |\n| `revoked_at` | `DATETIME` |  | Revoked At |\n| `client_ip` | `VARCHAR(45)` |  | Client Ip |\n| `user_agent` | `VARCHAR(512)` |  | User Agent |\n| `previous_token_id` | `VARCHAR(50)` |  | Previous Token Id |\n\n### `passwordresettoken`\n\n| Column | Type | Constraints | Description |\n|--------|------|-------------|-------------|\n| `id` | `VARCHAR` | PK, NOT NULL | Id |\n| `token_hash` | `VARCHAR` | NOT NULL | Token Hash |\n| `user_id` | `VARCHAR` | FK → users.id, NOT NULL | User Id |\n| `email` | `VARCHAR` | NOT NULL | Email |\n| `created_at` | `DATETIME` | NOT NULL | Created At |\n| `expires_at` | `DATETIME` | NOT NULL | Expires At |\n| `used_at` | `DATETIME` |  | Used At |\n| `revoked_at` | `DATETIME` |  | Revoked At |\n| `client_ip` | `VARCHAR` |  | Client Ip |\n| `user_agent` | `VARCHAR` |  | User Agent |\n| `max_uses` | `INTEGER` | NOT NULL | Max Uses |\n| `use_count` | `INTEGER` | NOT NULL | Use Count |\n| `revocation_reason` | `VARCHAR` |  | Revocation Reason |\n\n### `users` (users module)\n\n| Column | Type | Constraints | Description |\n|--------|------|-------------|-------------|\n| `is_deleted` | `BOOLEAN` | NOT NULL | Is Deleted |\n| `deleted_at` | `DATETIME` |  | Deleted At |\n| `created_at` | `DATETIME` |  | Created At |\n| `updated_at` | `DATETIME` |  | Updated At |\n| `id` | `VARCHAR` | PK, NOT NULL | Id |\n| `username` | `VARCHAR(100)` | UNIQUE, NOT NULL | Username |\n| `email` | `VARCHAR(255)` | UNIQUE, NOT NULL | Email |\n| `hashed_password` | `VARCHAR(255)` |  | Hashed Password |\n| `totp_secret` | `VARCHAR(32)` |  | Totp Secret |\n| `totp_enabled` | `BOOLEAN` | NOT NULL | Totp Enabled |\n| `backup_codes` | `VARCHAR(1000)` |  | Backup Codes |\n| `first_name` | `VARCHAR(100)` |  | First Name |\n| `last_name` | `VARCHAR(100)` |  | Last Name |\n| `profile_picture_url` | `VARCHAR(500)` |  | Profile Picture Url |\n| `bio` | `VARCHAR(1000)` |  | Bio |\n| `is_active` | `BOOLEAN` | NOT NULL | Is Active |\n| `is_verified` | `BOOLEAN` | NOT NULL | Is Verified |\n| `email_verified` | `BOOLEAN` | NOT NULL | Email Verified |\n| `last_login` | `DATETIME` |  | Last Login |\n| `role_id` | `VARCHAR` | FK → roles.id | Role Id |\n| `is_oauth_user` | `BOOLEAN` | NOT NULL | Is Oauth User |\n| `oauth_provider` | `VARCHAR(50)` |  | Oauth Provider |\n| `oauth_provider_id` | `VARCHAR(255)` |  | Oauth Provider Id |\n\n## Relationships\n\n- `oauth2account.user_id` → `users.id`\n- `oauth_accounts.user_id` → `users.id`\n- `password_reset_tokens.user_id` → `users.id`\n- `passwordresettoken.user_id` → `users.id`\n